<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Patient Dashboard | Medi-X</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="../css/dashboard.css">
</head>

<body>
  <div class="dashboard-container">
    <nav class="sidebar">
      <div class="sidebar-header">
        <img src="../assets/Medi-X_logo-removebg-preview.png" alt="Medi-X Logo" class="logo">
      </div>
      <ul class="nav-links">
        <li><a href="#dashboard" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
        <li><a href="#book-appointment"><i class="fas fa-calendar-plus"></i> Book Appointment</a></li>
        <li><a href="#my-appointments"><i class="fas fa-calendar-check"></i> My Appointments</a></li>
        <li><a href="#records"><i class="fas fa-file-medical"></i> Medical Records</a></li>
        <li><a href="#prescriptions"><i class="fas fa-prescription"></i> Prescriptions</a></li>
        <li><a href="#profile"><i class="fas fa-user"></i> Profile</a></li>
      </ul>
    </nav>

    <main class="main-content">
      <header class="dashboard-header">
        <div class="header-left">
          <h1>My Health Dashboard</h1>
        </div>
        <div class="header-right">
          <div class="patient-profile">
            <span id="patientName"></span>
            <div class="theme-switch-wrapper">
              <label class="theme-switch" for="darkModeToggle">
                <input type="checkbox" id="darkModeToggle" />
                <div class="slider round"></div>
              </label>
            </div>
            <button id="logout" class="btn btn-outline-danger"><i class="fas fa-sign-out-alt"></i> Logout</button>
          </div>
        </div>
      </header>

      <section class="health-summary" id="dashboard-section">
        <div class="section-header">
          <h2>Health Overview</h2>
          <button class="btn btn-sm btn-outline-primary" onclick="refreshDashboard()">
            <i class="fas fa-sync"></i>
          </button>
        </div>
        <div class="summary-cards">
          <div class="health-card">
            <i class="fas fa-heartbeat"></i>
            <h3>Last Vitals</h3>
            <p id="lastBP">BP: N/A</p>
            <p id="lastHeartRate">Heart Rate: N/A</p>
          </div>
          <div class="health-card">
            <i class="fas fa-pills"></i>
            <h3>Active Medications</h3>
            <p id="activeMedicationsCount">0 Prescriptions</p>
          </div>
          <div class="health-card">
            <i class="fas fa-calendar-check"></i>
            <h3>Next Appointment</h3>
            <p id="nextAppointmentDate">No upcoming appointments</p>
          </div>
        </div>
      </section>

      <section class="appointments-section" id="my-appointments-section" style="display: none;">
        <h2>Upcoming Appointments</h2>
        <div id="upcomingAppointmentsList" class="appointments-list"></div>
        <hr class="my-5">
        <h2>Past Appointments</h2>
        <div id="pastAppointmentsList" class="appointments-list"></div>
      </section>

      <section class="appointment-section" id="book-appointment-section" style="display: none;">
        <h2>Book Appointment</h2>
        <form id="appointmentForm" class="appointment-form">
          <div class="form-group">
            <select id="hospitalSelect" required>
              <option value=""></option>
            </select>
          </div>
          <div class="form-group">
            <select id="timeSlot" required>
              <option value="">Dr. Serlin</option>
            </select>
          </div>
          <div class="form-group">
            <input type="date" id="appointmentDate" required>
          </div>
          <div class="form-group">
            <select id="time" required>
              <option value="">Select Time</option>
            </select>
          </div>
          <div class="form-group">
            <textarea id="reason" placeholder="Reason for visit" required></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Book Appointment</button>
        </form>
      </section>

      <section class="records-section" id="records-section" style="display: none;">
        <div class="section-header">
          <h2>Recent Medical Records</h2>
          <div class="section-actions">
            <select id="recordsFilter" class="form-select form-select-sm">
              <option value="all">All Records</option>
              <option value="recent">Last 3 Months</option>
              <option value="year">This Year</option>
            </select>
            <button id="downloadRecordsBtn" class="btn btn-sm btn-outline-secondary"><i class="fas fa-download"></i>
              Download PDF</button>
          </div>
        </div>
        <div id="medicalRecordsList" class="records-list">
          <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i> Loading records...
          </div>
        </div>
      </section>

      <section class="prescriptions-section" id="prescriptions-section" style="display: none;">
        <h2>Current Prescriptions</h2>
        <div id="prescriptionsList" class="prescriptions-list">
        </div>
      </section>

      <section class="profile-section" id="profile-section" style="display: none;">
        <h2>My Profile</h2>
        <div class="profile-card">
          <img src="../assets/avatar.png" alt="Patient Avatar" class="profile-avatar">
          <label for="profileImage" class="change-avatar">
            <i class="fas fa-camera"></i>
          </label>
          <input type="file" id="profileImage" hidden accept="image/*">
          <h3 id="profileName"></h3>
          <p id="profileId">Patient ID: </p>
          <div class="profile-details">
            <p><strong>Email:</strong> <span id="profileEmail"></span></p>
            <p><strong>Phone:</strong> <span id="profilePhone"></span></p>
            <p><strong>Address:</strong> <span id="profileAddress"></span></p>
          </div>
          <button class="btn btn-primary" onclick="openEditProfile()">Edit Profile</button>
        </div>
      </section>

      <div id="editProfileModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
          <span class="close-modal" onclick="closeEditProfile()">&times;</span>
          <h3>Edit Profile</h3>
          <form id="editProfileForm" class="modal-form">
            <input type="text" id="editName" placeholder="Full Name" required>
            <input type="tel" id="editPhone" placeholder="Phone Number" required>
            <textarea id="editAddress" placeholder="Address" required></textarea>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </form>
        </div>
      </div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
  <script src="../js/shared.js"></script>
  <script src="../js/patient.js"></script>
</body>

</html>